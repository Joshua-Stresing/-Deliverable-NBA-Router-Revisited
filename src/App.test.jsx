//needs to be totally rewrote.
//reminder, try nesting if possible
